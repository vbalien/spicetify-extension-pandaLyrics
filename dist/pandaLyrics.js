var pandaLyrics=(()=>{var e=class{constructor(t){this.port=t}connect(){this.socket=new WebSocket(`ws://localhost:${this.port}/pandaLyrics`),this.socket.addEventListener("open",t=>{Spicetify.showNotification("PandaLyrics Connected."),this.tickTimer&&clearInterval(this.tickTimer),this.tickTimer=setInterval(this.tick.bind(this),200),this.sendSong()}),this.socket.addEventListener("close",t=>{this.tickTimer&&clearInterval(this.tickTimer),setTimeout(()=>{this.connect()},1e3)}),this.socket.addEventListener("error",t=>{this.tickTimer&&clearInterval(this.tickTimer),setTimeout(()=>{this.connect()},1e3)})}tick(){var t=Spicetify.Player.getProgress();this.emitEvent({type:"tick",data:{time:t}})}get isReady(){var t;return(null==(t=this.socket)?void 0:t.readyState)===WebSocket.OPEN}sendSong(){var t,e=Spicetify.Player.data||Spicetify.Queue;e&&e.track&&((e=e.track.metadata)&&(t=e.title,e=e.artist_name,this.emitEvent({type:"songchange",data:{title:null!=t?t:"",artist:null!=e?e:""}})))}emitEvent(t){var e;null!=(e=this.socket)&&e.send(JSON.stringify(t))}};var t=async function(){const t=new e(8999);t.connect(),Spicetify.Player.addEventListener("songchange",()=>{t.isReady&&t.sendSong()})};(async()=>{await t()})()})();